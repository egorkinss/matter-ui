var content=(function(){"use strict";function wt(e){return e}const F="mm-team-sidebar-resizer",be="mm-team-sidebar-expanded",j=52,he=230,pe=70,v=(e,t=!1)=>{const a=localStorage.getItem(e);return a===null?t:a==="1"||a==="true"},fe=(e,t)=>{localStorage.setItem(e,t?"1":"0")},je=()=>{const e=document.getElementById("root");return!!(e&&(document.getElementById("mattermost-view-container")||e.querySelector(".channel-view"))||document.querySelector('meta[name="application-name"][content="Mattermost"]')||document.querySelector('meta[name="apple-mobile-web-app-title"][content="Mattermost"]')||document.querySelector("noscript")?.textContent?.includes("Mattermost"))},S="matterUiSettings",A="matterUiButton",V="mm-team-sidebar-resizer-enabled",K="mm-dm-view-enabled",X="mm-hide-calls-enabled",Ee="mm-team-sidebar-width",Ve=300,Y="mm-team-sidebar-animating",y=(e,t)=>{const n=(t??e.getBoundingClientRect().width)>pe;e.classList.toggle(be,n)},Ke=e=>{window.addEventListener("mm-extension-setting-changed",t=>{t.detail?.key===V&&ve(e)}),ve(e)},ve=e=>{if(!v(V,!0)){Xe(e);return}Ye(e)},Xe=e=>{const t=e.querySelector(`#${F}`);t&&t.remove(),e.classList.remove(be),e.classList.remove(Y),e.style.width="",e.style.maxWidth="",e.style.flex="",e.style.minWidth="",e.style.position=""},Ye=e=>{if(e.querySelector(`#${F}`))return;getComputedStyle(e).position!=="relative"&&(e.style.position="relative");const a=e.getBoundingClientRect().width;e.style.flex="0 0 auto",e.style.minWidth=`${Math.max(j,Math.round(a))}px`;const n=localStorage.getItem(Ee);if(n){const c=parseFloat(n);isNaN(c)||(e.style.width=`${c}px`,e.style.maxWidth=`${c}px`)}y(e);const s=document.createElement("div");s.id=F,s.style.position="absolute",s.style.top="0",s.style.right="0",s.style.width="6px",s.style.height="100%",s.style.cursor="col-resize",s.style.zIndex="9999",e.appendChild(s);let i=!1,l=0,m=0;const _=()=>{const c=e.getBoundingClientRect().width;localStorage.setItem(Ee,c.toString())},o=c=>{if(!i)return;const E=parseFloat(e.style.minWidth)||j,b=Math.min(he,Math.max(E,m+(c.clientX-l)));e.style.width=`${b}px`,e.style.maxWidth=`${b}px`,y(e)},r=()=>{i&&(i=!1,document.body.style.cursor="",document.body.style.userSelect="",y(e),_(),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",r))};s.addEventListener("mousedown",c=>{c.preventDefault(),i=!0,l=c.clientX,m=e.getBoundingClientRect().width,document.body.style.cursor="col-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",o),window.addEventListener("mouseup",r)}),s.addEventListener("dblclick",c=>{c.preventDefault();const b=e.getBoundingClientRect().width>pe;let g;b?g=parseFloat(e.style.minWidth)||j:g=he,e.classList.add(Y),e.style.width=`${g}px`,e.style.maxWidth=`${g}px`,b||y(e,g),_(),setTimeout(()=>{e.classList.remove(Y),b&&y(e,g)},Ve)})},Ze=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" x="0" y="0" viewBox="0 0 548.244 548.244" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path fill-rule="evenodd" d="M392.19 156.054 211.268 281.667 22.032 218.58C8.823 214.168-.076 201.775 0 187.852c.077-13.923 9.078-26.24 22.338-30.498L506.15 1.549c11.5-3.697 24.123-.663 32.666 7.88 8.542 8.543 11.577 21.165 7.879 32.666L390.89 525.906c-4.258 13.26-16.575 22.261-30.498 22.338-13.923.076-26.316-8.823-30.728-22.032l-63.393-190.153z" clip-rule="evenodd" fill="#ffffff" opacity="1" data-original="#ffffff" class=""></path></g></svg>
`,d={TEAM_SIDEBAR:".team-sidebar",DROPPABLE_TEAMS:'[data-rbd-droppable-id="my_teams"]',DRAGGABLE_TEAM_ITEM:"a.draggable-team-container",TEAM_CONTAINER:".team-container",TEAM_ICON:".TeamIcon",SIDEBAR_CHANNEL_GROUP:".SidebarChannelGroup",SIDEBAR_CHANNEL_GROUP_HEADER_TEXT:".SidebarChannelGroupHeader_text",CHANNEL_LIST_ITEM:"li, .SidebarChannel, .SidebarChannelGroup",SIDEBAR_CHANNEL_BADGE:".badge, .SidebarChannelBadge, .SidebarChannelBadge__icon",TEAM_HEADER:[".team__name",".sidebar-header__title",'[data-testid="teamSidebarHeader"] .team__name',".SidebarHeader .team__name",".SidebarHeader h1",'[data-testid="teamSidebarHeader"] h1',".sidebarHeaderContainer h1"],ICON_CHEVRON_DOWN:".icon-chevron-down",USER_SETTINGS_MODAL:".UserSettingsModal",TAB_LIST:"#tabList",PLUGIN_PREFERENCES_HEADER:'[aria-labelledby="userSettingsModal.pluginPreferences.header"]',SETTINGS_CONTENT:".settings-content div",NAV_PILLS_TAB:".nav-pills__tab",CALLS_JOIN_BUTTON:"#calls-join-button",ROOT:"#root",VIEW_CONTAINER:"#mattermost-view-container",CHANNEL_VIEW:".channel-view"},Z=()=>document.querySelector(d.TEAM_SIDEBAR),J={en:{dm_header:"Direct Messages",unread_header:"Unreads",dm_item_label:"Direct",dm_item_aria_label:"Direct Messages",settings_title:"MatterUI",settings_header:"MatterUI Settings",setting_resizer_title:"Resizable Team Sidebar",setting_resizer_desc:"Allows resizing the team sidebar width",setting_dm_title:"Separate Direct Messages",setting_dm_desc:"Moves direct messages to a separate tab",setting_calls_title:"Hide Call Button",setting_calls_desc:"Hides the call button in the channel header",label_on:"On",label_off:"Off",label_edit:"Edit",label_save:"Save",label_cancel:"Cancel"},"en-AU":{dm_header:"Direct Messages",unread_header:"Unreads",dm_item_label:"Direct",dm_item_aria_label:"Direct Messages",settings_title:"MatterUI",settings_header:"MatterUI Settings",setting_resizer_title:"Resizable Team Sidebar",setting_resizer_desc:"Allows resizing the team sidebar width",setting_dm_title:"Separate Direct Messages",setting_dm_desc:"Moves direct messages to a separate tab",setting_calls_title:"Hide Call Button",setting_calls_desc:"Hides the call button in the channel header",label_on:"On",label_off:"Off",label_edit:"Edit",label_save:"Save",label_cancel:"Cancel"},ru:{dm_header:"Личные сообщения",unread_header:"Непрочитанные",dm_item_label:"Личные",dm_item_aria_label:"Личные сообщения",settings_title:"MatterUI",settings_header:"Настройки MatterUI",setting_resizer_title:"Подвижное меню команд",setting_resizer_desc:"Позволяет изменять ширину боковой панели команд",setting_dm_title:"Личные сообщения отдельно",setting_dm_desc:"Выносит личные сообщения в отдельную вкладку",setting_calls_title:"Скрыть кнопку звонков",setting_calls_desc:"Скрывает кнопку звонков в заголовке канала",label_on:"Вкл",label_off:"Выкл",label_edit:"Изменить",label_save:"Сохранить",label_cancel:"Отмена"},de:{dm_header:"Direktnachrichten",unread_header:"Ungelesen",dm_item_label:"Direkt",dm_item_aria_label:"Direktnachrichten",settings_title:"MatterUI",settings_header:"MatterUI Einstellungen",setting_resizer_title:"Anpassbare Team-Seitenleiste",setting_resizer_desc:"Erlaubt das Ändern der Breite der Team-Seitenleiste",setting_dm_title:"Separate Direktnachrichten",setting_dm_desc:"Verschiebt Direktnachrichten in einen eigenen Tab",setting_calls_title:"Anruf-Button verbergen",setting_calls_desc:"Verbirgt den Anruf-Button im Kanal-Header",label_on:"Ein",label_off:"Aus",label_edit:"Bearbeiten",label_save:"Speichern",label_cancel:"Abbrechen"},es:{dm_header:"Mensajes Directos",unread_header:"No leídos",dm_item_label:"Directos",dm_item_aria_label:"Mensajes Directos",settings_title:"MatterUI",settings_header:"Configuración de MatterUI",setting_resizer_title:"Barra lateral de equipos redimensionable",setting_resizer_desc:"Permite cambiar el ancho de la barra lateral de equipos",setting_dm_title:"Mensajes Directos separados",setting_dm_desc:"Mueve los mensajes directos a una pestaña separada",setting_calls_title:"Ocultar botón de llamada",setting_calls_desc:"Oculta el botón de llamada en el encabezado del canal",label_on:"Encendido",label_off:"Apagado",label_edit:"Editar",label_save:"Guardar",label_cancel:"Cancelar"},fr:{dm_header:"Messages Directs",unread_header:"Non lus",dm_item_label:"Directs",dm_item_aria_label:"Messages Directs",settings_title:"MatterUI",settings_header:"Paramètres MatterUI",setting_resizer_title:"Barre latérale d'équipe redimensionnable",setting_resizer_desc:"Permet de redimensionner la largeur de la barre latérale d'équipe",setting_dm_title:"Messages Directs séparés",setting_dm_desc:"Déplace les messages directs dans un onglet séparé",setting_calls_title:"Masquer le bouton d'appel",setting_calls_desc:"Masque le bouton d'appel dans l'en-tête du canal",label_on:"Activé",label_off:"Désactivé",label_edit:"Modifier",label_save:"Enregistrer",label_cancel:"Annuler"},it:{dm_header:"Messaggi Diretti",unread_header:"Non letti",dm_item_label:"Diretti",dm_item_aria_label:"Messaggi Diretti",settings_title:"MatterUI",settings_header:"Impostazioni MatterUI",setting_resizer_title:"Barra laterale team ridimensionabile",setting_resizer_desc:"Consente di ridimensionare la larghezza della barra laterale del team",setting_dm_title:"Messaggi Diretti separati",setting_dm_desc:"Sposta i messaggi diretti in una scheda separata",setting_calls_title:"Nascondi pulsante chiamata",setting_calls_desc:"Nasconde il pulsante di chiamata nell'intestazione del canale",label_on:"On",label_off:"Off",label_edit:"Modifica",label_save:"Salva",label_cancel:"Annulla"},hu:{dm_header:"Közvetlen üzenetek",unread_header:"Olvasatlanok",dm_item_label:"Üzenetek",dm_item_aria_label:"Közvetlen üzenetek",settings_title:"MatterUI",settings_header:"MatterUI Beállítások",setting_resizer_title:"Átméretezhető csapat oldalsáv",setting_resizer_desc:"Lehetővé teszi a csapat oldalsáv szélességének módosítását",setting_dm_title:"Külön Közvetlen üzenetek",setting_dm_desc:"A közvetlen üzeneteket egy külön fülre helyezi át",setting_calls_title:"Hívás gomb elrejtése",setting_calls_desc:"Elrejti a hívás gombot a csatorna fejlécében",label_on:"Be",label_off:"Ki",label_edit:"Szerkesztés",label_save:"Mentés",label_cancel:"Mégse"},nl:{dm_header:"Directe Berichten",unread_header:"Ongelezen",dm_item_label:"Direct",dm_item_aria_label:"Directe Berichten",settings_title:"MatterUI",settings_header:"MatterUI Instellingen",setting_resizer_title:"Aanpasbare Team Zijbalk",setting_resizer_desc:"Maakt het mogelijk de breedte van de team zijbalk aan te passen",setting_dm_title:"Aparte Directe Berichten",setting_dm_desc:"Verplaatst directe berichten naar een apart tabblad",setting_calls_title:"Verberg Belknop",setting_calls_desc:"Verbergt de belknop in de kanaalkop",label_on:"Aan",label_off:"Uit",label_edit:"Bewerken",label_save:"Opslaan",label_cancel:"Annuleren"},pl:{dm_header:"Wiadomości Bezpośrednie",unread_header:"Nieprzeczytane",dm_item_label:"Wiadomości",dm_item_aria_label:"Wiadomości Bezpośrednie",settings_title:"MatterUI",settings_header:"Ustawienia MatterUI",setting_resizer_title:"Zmienny rozmiar paska zespołów",setting_resizer_desc:"Pozwala na zmianę szerokości paska bocznego zespołów",setting_dm_title:"Oddzielne Wiadomości Bezpośrednie",setting_dm_desc:"Przenosi wiadomości bezpośrednie do osobnej zakładki",setting_calls_title:"Ukryj przycisk połączenia",setting_calls_desc:"Ukrywa przycisk połączenia w nagłówku kanału",label_on:"Wł.",label_off:"Wył.",label_edit:"Edytuj",label_save:"Zapisz",label_cancel:"Anuluj"},"pt-BR":{dm_header:"Mensagens Diretas",unread_header:"Não lidas",dm_item_label:"Diretas",dm_item_aria_label:"Mensagens Diretas",settings_title:"MatterUI",settings_header:"Configurações MatterUI",setting_resizer_title:"Barra lateral de equipes redimensionável",setting_resizer_desc:"Permite redimensionar a largura da barra lateral de equipes",setting_dm_title:"Mensagens Diretas separadas",setting_dm_desc:"Move as mensagens diretas para uma aba separada",setting_calls_title:"Ocultar botão de chamada",setting_calls_desc:"Oculta o botão de chamada no cabeçalho do canal",label_on:"Ligado",label_off:"Desligado",label_edit:"Editar",label_save:"Salvar",label_cancel:"Cancelar"},ro:{dm_header:"Mesaje Directe",unread_header:"Necitite",dm_item_label:"Directe",dm_item_aria_label:"Mesaje Directe",settings_title:"MatterUI",settings_header:"Setări MatterUI",setting_resizer_title:"Bară laterală echipe redimensionabilă",setting_resizer_desc:"Permite redimensionarea lățimii barei laterale a echipelor",setting_dm_title:"Mesaje Directe separate",setting_dm_desc:"Mută mesajele directe într-o filă separată",setting_calls_title:"Ascunde buton apel",setting_calls_desc:"Ascunde butonul de apel din antetul canalului",label_on:"Pornit",label_off:"Oprit",label_edit:"Editare",label_save:"Salvare",label_cancel:"Anulare"},sv:{dm_header:"Direktmeddelanden",unread_header:"Olästa",dm_item_label:"Direkt",dm_item_aria_label:"Direktmeddelanden",settings_title:"MatterUI",settings_header:"MatterUI Inställningar",setting_resizer_title:"Anpassningsbar Team-sidofält",setting_resizer_desc:"Tillåter ändring av bredden på team-sidofältet",setting_dm_title:"Separata Direktmeddelanden",setting_dm_desc:"Flyttar direktmeddelanden till en separat flik",setting_calls_title:"Dölj samtalsknapp",setting_calls_desc:"Döljer samtalsknappen i kanalrubriken",label_on:"På",label_off:"Av",label_edit:"Redigera",label_save:"Spara",label_cancel:"Avbryt"},tr:{dm_header:"Doğrudan Mesajlar",unread_header:"Okunmamış",dm_item_label:"Mesajlar",dm_item_aria_label:"Doğrudan Mesajlar",settings_title:"MatterUI",settings_header:"MatterUI Ayarları",setting_resizer_title:"Yeniden Boyutlandırılabilir Takım Kenar Çubuğu",setting_resizer_desc:"Takım kenar çubuğu genişliğinin değiştirilmesine izin verir",setting_dm_title:"Ayrı Doğrudan Mesajlar",setting_dm_desc:"Doğrudan mesajları ayrı bir sekmeye taşır",setting_calls_title:"Arama Düğmesini Gizle",setting_calls_desc:"Kanal başlığındaki arama düğmesini gizler",label_on:"Açık",label_off:"Kapalı",label_edit:"Düzenle",label_save:"Kaydet",label_cancel:"İptal"},bg:{dm_header:"Директни съобщения",unread_header:"Непрочетени",dm_item_label:"Съобщения",dm_item_aria_label:"Директни съобщения",settings_title:"MatterUI",settings_header:"Настройки на MatterUI",setting_resizer_title:"Преоразмерима странична лента",setting_resizer_desc:"Позволява промяна на ширината на страничната лента на екипите",setting_dm_title:"Отделни директни съобщения",setting_dm_desc:"Премества директните съобщения в отделен раздел",setting_calls_title:"Скрий бутона за повикване",setting_calls_desc:"Скрива бутона за повикване в заглавката на канала",label_on:"Вкл",label_off:"Изкл",label_edit:"Редактиране",label_save:"Запази",label_cancel:"Отказ"},uk:{dm_header:"Особисті повідомлення",unread_header:"Непрочитані",dm_item_label:"Особисті",dm_item_aria_label:"Особисті повідомлення",settings_title:"MatterUI",settings_header:"Налаштування MatterUI",setting_resizer_title:"Змінна ширина панелі команд",setting_resizer_desc:"Дозволяє змінювати ширину бічної панелі команд",setting_dm_title:"Окремі особисті повідомлення",setting_dm_desc:"Виносить особисті повідомлення в окрему вкладку",setting_calls_title:"Приховати кнопку дзвінка",setting_calls_desc:"Приховує кнопку дзвінка в заголовку каналу",label_on:"Увімк",label_off:"Вимк",label_edit:"Змінити",label_save:"Зберегти",label_cancel:"Скасувати"},fa:{dm_header:"پیام‌های مستقیم",unread_header:"خوانده نشده",dm_item_label:"پیام‌ها",dm_item_aria_label:"پیام‌های مستقیم",settings_title:"MatterUI",settings_header:"تنظیمات MatterUI",setting_resizer_title:"تغییر اندازه نوار کناری تیم",setting_resizer_desc:"اجازه تغییر عرض نوار کناری تیم را می‌دهد",setting_dm_title:"پیام‌های مستقیم جداگانه",setting_dm_desc:"پیام‌های مستقیم را به یک تب جداگانه منتقل می‌کند",setting_calls_title:"مخفی کردن دکمه تماس",setting_calls_desc:"دکمه تماس را در سربرگ کانال مخفی می‌کند",label_on:"روشن",label_off:"خاموش",label_edit:"ویرایش",label_save:"ذخیره",label_cancel:"لغو"},ko:{dm_header:"다이렉트 메시지",unread_header:"읽지 않음",dm_item_label:"DM",dm_item_aria_label:"다이렉트 메시지",settings_title:"MatterUI",settings_header:"MatterUI 설정",setting_resizer_title:"팀 사이드바 크기 조절",setting_resizer_desc:"팀 사이드바 너비를 조절할 수 있습니다",setting_dm_title:"다이렉트 메시지 분리",setting_dm_desc:"다이렉트 메시지를 별도 탭으로 이동합니다",setting_calls_title:"통화 버튼 숨기기",setting_calls_desc:"채널 헤더의 통화 버튼을 숨깁니다",label_on:"켜기",label_off:"끄기",label_edit:"편집",label_save:"저장",label_cancel:"취소"},"zh-CN":{dm_header:"私信",unread_header:"未读",dm_item_label:"私信",dm_item_aria_label:"私信",settings_title:"MatterUI",settings_header:"MatterUI 设置",setting_resizer_title:"可调整团队侧边栏",setting_resizer_desc:"允许调整团队侧边栏宽度",setting_dm_title:"独立私信标签",setting_dm_desc:"将私信移动到单独的标签页",setting_calls_title:"隐藏通话按钮",setting_calls_desc:"隐藏频道顶部的通话按钮",label_on:"开启",label_off:"关闭",label_edit:"编辑",label_save:"保存",label_cancel:"取消"},"zh-TW":{dm_header:"私訊",unread_header:"未讀",dm_item_label:"私訊",dm_item_aria_label:"私訊",settings_title:"MatterUI",settings_header:"MatterUI 設定",setting_resizer_title:"可調整團隊側邊欄",setting_resizer_desc:"允許調整團隊側邊欄寬度",setting_dm_title:"獨立私訊分頁",setting_dm_desc:"將私訊移動到單獨的分頁",setting_calls_title:"隱藏通話按鈕",setting_calls_desc:"隱藏頻道標題的通話按鈕",label_on:"開啟",label_off:"關閉",label_edit:"編輯",label_save:"儲存",label_cancel:"取消"},ja:{dm_header:"ダイレクトメッセージ",unread_header:"未読",dm_item_label:"DM",dm_item_aria_label:"ダイレクトメッセージ",settings_title:"MatterUI",settings_header:"MatterUI 設定",setting_resizer_title:"チームサイドバーのサイズ変更",setting_resizer_desc:"チームサイドバーの幅を変更できるようにします",setting_dm_title:"ダイレクトメッセージを分離",setting_dm_desc:"ダイレクトメッセージを別のタブに移動します",setting_calls_title:"通話ボタンを隠す",setting_calls_desc:"チャンネルヘッダーの通話ボタンを非表示にします",label_on:"オン",label_off:"オフ",label_edit:"編集",label_save:"保存",label_cancel:"キャンセル"}};let D="en";const O=e=>e in J,B=e=>{if(!e)return"en";if(O(e))return e;const t=e.split("-")[0];return O(t)?t:"en"},Je=async()=>{try{const n=await fetch("/api/v4/users/me");if(n.ok){const s=await n.json();if(s&&s.locale){Qe(s.locale);return}}}catch(n){console.warn("Failed to fetch user locale",n)}const e=document.documentElement.lang,t=navigator.language,a=B(e)!=="en"?B(e):B(t);O(a)?D=a:D="en"},Qe=e=>{const t=B(e);O(t)?D=t:D="en"},u=e=>{const t=J[D],a=J.en;return t?.[e]||a?.[e]||e},et="mm-dm-view-active",Se="mm-dm-view-has-unread",Ae="mm-dm-view-state",ye="direct_messages_",De="unreads_",C="mm-dm-group-hidden",f="mm-dm-group-show",h="mm-dm-unread-hidden",I="mm-dm-group-no-header",L="mm-dm-group-hide-add",p="mm-unread-dm-hidden",T="mm-unread-empty",tt=1500,at=`data:image/svg+xml;utf8,${encodeURIComponent(Ze)}`,Ce="mm-dm-feature-enabled";let Q=!1,k=!1,ee=0,te=!1,ae=0,ne=0,M=null,N=null,w=null;const nt=e=>{window.addEventListener("mm-extension-setting-changed",t=>{t.detail?.key===K&&Ie(e)}),Ie(e)},Ie=e=>{if(!v(K)){st(e);return}it(e)},st=e=>{const t=e.querySelector(d.DROPPABLE_TEAMS);if(t){const r=t.querySelector(".mm-dm-team-item");r&&r.remove();const c=t.querySelector(".mm-dm-team-divider");c&&c.remove(),M&&(t.removeEventListener("click",M),M=null),N&&(t.removeEventListener("keydown",N),N=null),delete t.dataset.mmDmHandlersAttached}w&&(w.disconnect(),w=null,delete document.documentElement.dataset.mmDmObserverAttached),document.documentElement.classList.remove(Ce),x(!1),document.querySelectorAll(`.${C}`).forEach(r=>r.classList.remove(C)),document.querySelectorAll(`.${f}`).forEach(r=>r.classList.remove(f)),document.querySelectorAll(`.${I}`).forEach(r=>r.classList.remove(I)),document.querySelectorAll(`.${L}`).forEach(r=>r.classList.remove(L)),document.querySelectorAll(`.${h}`).forEach(r=>r.classList.remove(h)),document.querySelectorAll(`.${p}`).forEach(r=>r.classList.remove(p)),document.querySelectorAll(`.${T}`).forEach(r=>r.classList.remove(T)),we();const o=Re();if(o){o.dataset.mmOriginalTeamName&&(o.textContent=o.dataset.mmOriginalTeamName,delete o.dataset.mmOriginalTeamName),o.classList.remove("mm-dm-team-header-hidden");const r=Ue(o);r&&r.dataset.mmOriginalDisplay&&(r.style.display=r.dataset.mmOriginalDisplay,delete r.dataset.mmOriginalDisplay)}z()&&x(!1)},it=e=>{document.documentElement.classList.add(Ce);const t=e.querySelector(d.DROPPABLE_TEAMS);if(!t)return;let a=t.querySelector(".mm-dm-team-item");a||(a=rt(),t.insertBefore(a,t.firstChild));let n=t.querySelector(".mm-dm-team-divider");n||(n=document.createElement("div"),n.className="mm-dm-team-divider",a.insertAdjacentElement("afterend",n)),t.dataset.mmDmHandlersAttached!=="true"&&(t.dataset.mmDmHandlersAttached="true",M=s=>{const i=s.target?.closest(d.DRAGGABLE_TEAM_ITEM);if(i){if(i.classList.contains("mm-dm-team-item")){s.preventDefault(),x(!0);return}z()&&x(!1)}},N=s=>{if(s.key!=="Enter"&&s.key!==" ")return;const i=s.target?.closest(d.DRAGGABLE_TEAM_ITEM);!i||!i.classList.contains("mm-dm-team-item")||(s.preventDefault(),x(!0))},t.addEventListener("click",M),t.addEventListener("keydown",N)),document.documentElement.dataset.mmDmObserverAttached!=="true"&&(document.documentElement.dataset.mmDmObserverAttached="true",w=new MutationObserver(()=>{if(!k&&!(Date.now()<ee)){if(z()){lt();return}dt()}}),w.observe(document.documentElement,{childList:!0,subtree:!0})),se()},rt=()=>{const e=document.createElement("a");e.className="draggable-team-container mm-dm-team-item",e.href="#",e.setAttribute("role","button"),e.setAttribute("aria-label",u("dm_item_aria_label")),e.tabIndex=0;const t=document.createElement("div");t.className="team-container";const a=document.createElement("div");a.className="team-btn";const n=document.createElement("div");n.className="TeamIcon TeamIcon__sm withImage";const s=document.createElement("div");s.className="TeamIcon__content";const i=document.createElement("div");i.className="TeamIcon__image TeamIcon__sm mm-dm-team-icon",i.setAttribute("role","img"),i.setAttribute("aria-label",u("dm_item_aria_label")),i.style.backgroundImage=`url("${at}")`,s.appendChild(i),n.appendChild(s),a.appendChild(n),t.appendChild(a);const l=document.createElement("span");l.className="badge badge-max-number pull-right small mm-dm-unread-badge",t.appendChild(l);const m=document.createElement("span");return m.className="mm-team-label",m.textContent=u("dm_item_label"),e.appendChild(t),e.appendChild(m),e},z=()=>v(Ae),x=e=>{fe(Ae,e),se()},se=()=>{if(!k){k=!0;try{ee=Date.now()+150;const e=z();document.documentElement.classList.toggle(et,e);const t=document.querySelector(".mm-dm-team-item");if(t&&t.classList.toggle("mm-dm-team-active",e),ot(e),!e){ct(),Te(),Le(!1);return}const a=H(De)??Me("unreads"),n=H(ye),s=ie(n);re(s,xe(n));const l=(a?mt(a):0)>0;document.documentElement.classList.toggle(Se,l),a&&(a.classList.remove(T),a.classList.toggle(C,!l),a.classList.toggle(f,l),Ne(a,l?u("unread_header"):null)),n&&(n.classList.add(f),n.classList.toggle(I,!l),n.classList.add(L),Ne(n,l?u("dm_header"):null)),Le(!0)}finally{k=!1}}},lt=()=>{Q||(Q=!0,window.requestAnimationFrame(()=>{Q=!1,se()}))},dt=()=>{te||(te=!0,window.requestAnimationFrame(()=>{te=!1,Te()}))},Le=e=>{const t=Re();if(!t)return;!t.dataset.mmOriginalTeamName&&t.textContent&&(t.dataset.mmOriginalTeamName=t.textContent);const a=Ue(t);if(a&&!a.dataset.mmOriginalDisplay&&(a.dataset.mmOriginalDisplay=a.style.display),e){t.classList.remove("mm-dm-team-header-hidden"),t.textContent=u("dm_header"),a&&a.style.display!=="none"&&(a.style.display="none");return}const n=t.dataset.mmOriginalTeamName;if(n&&t.textContent!==n&&(t.textContent=n),a){const s=a.dataset.mmOriginalDisplay??"";a.style.display!==s&&(a.style.display=s)}},ot=e=>{const t=Z();if(!t)return;Array.from(t.querySelectorAll(d.DRAGGABLE_TEAM_ITEM)).forEach(n=>{const s=n.querySelector(d.TEAM_CONTAINER),i=n.querySelector(".TeamIcon");if(n.classList.contains("mm-dm-team-item")){const l=n.querySelector(".TeamIcon");e?(s?.classList.add("active"),l?.classList.add("active")):(s?.classList.remove("active"),l?.classList.remove("active"));return}if(e){n.classList.remove("active"),s?.classList.remove("active"),i?.classList.remove("active");return}})},ct=()=>{document.documentElement.classList.remove(Se),we(),document.querySelectorAll(`.${C}`).forEach(i=>i.classList.remove(C)),document.querySelectorAll(`.${f}`).forEach(i=>i.classList.remove(f)),document.querySelectorAll(`.${h}`).forEach(i=>i.classList.remove(h)),document.querySelectorAll(`.${I}`).forEach(i=>i.classList.remove(I)),document.querySelectorAll(`.${L}`).forEach(i=>i.classList.remove(L))},Te=()=>{if(ee=Date.now()+150,z())return;const e=H(De)??Me("unreads"),t=H(ye),a=xe(t);if(!e){re(ie(t),a);return}let n=0;Array.from(e.querySelectorAll("a")).forEach(i=>{const l=ze(i),m=le(i);l?(i.classList.add(p),m&&m.classList.add(p)):(i.classList.remove(p),m&&m.classList.remove(p),n+=1)}),re(ie(t),a),n===0?e.classList.add(T):e.classList.remove(T)},H=e=>{const t=document.querySelector(`[data-rbd-draggable-id^="${e}"]`);return t?t.classList.contains("SidebarChannelGroup")?t:t.closest(d.SIDEBAR_CHANNEL_GROUP):document.querySelector(`[data-rbd-droppable-id^="${e}"]`)?.closest(d.SIDEBAR_CHANNEL_GROUP)??null},Me=e=>Array.from(document.querySelectorAll(d.SIDEBAR_CHANNEL_GROUP_HEADER_TEXT)).find(n=>n.textContent?.trim().toLowerCase()===e)?.closest(d.SIDEBAR_CHANNEL_GROUP)??null,Ne=(e,t)=>{const a=e.querySelector(d.SIDEBAR_CHANNEL_GROUP_HEADER_TEXT);if(a){if(a.dataset.mmOriginalHeaderText===void 0&&(a.dataset.mmOriginalHeaderText=a.textContent??""),t===null){const n=a.dataset.mmOriginalHeaderText??"";a.textContent!==n&&(a.textContent=n);return}a.textContent!==t&&(a.textContent=t)}},we=()=>{document.querySelectorAll(d.SIDEBAR_CHANNEL_GROUP_HEADER_TEXT).forEach(t=>{t.dataset.mmOriginalHeaderText!==void 0&&(t.textContent=t.dataset.mmOriginalHeaderText,delete t.dataset.mmOriginalHeaderText)})},mt=e=>{const t=Array.from(e.querySelectorAll("a"));let a=0;return t.forEach(n=>{const s=le(n);if(ze(n)){n.classList.remove(h),n.classList.remove(p),s&&(s.classList.remove(h),s.classList.remove(p)),a+=1;return}n.classList.add(h),s&&s.classList.add(h)}),a},ze=e=>{const t=e.getAttribute("href")??"";return/\/messages\//.test(t)},ie=e=>{if(!e)return 0;const t=Array.from(e.querySelectorAll('a[href*="/messages/"]'));let a=0;return t.forEach(n=>{_t(n)&&(a+=1)}),a},_t=e=>{const t=le(e),a=`${e.className} ${t?.className??""}`;if(/unread/i.test(a)||(e.getAttribute("aria-label")?.toLowerCase()??"").includes("непрочитан"))return!0;const s=t?.querySelector(d.SIDEBAR_CHANNEL_BADGE);return!!(s&&!s.classList.contains("mm-dm-unread-badge"))},xe=e=>e?e.querySelector('a[href*="/messages/"]')!==null:!1,re=(e,t)=>{const a=document.querySelector(".mm-dm-team-item");if(!a)return;const n=a.querySelector(d.TEAM_CONTAINER);if(!n)return;let s=n.querySelector(".mm-dm-unread-badge");if(s||(s=document.createElement("span"),s.className="badge badge-max-number pull-right small mm-dm-unread-badge",n.appendChild(s)),e<=0){const l=Date.now();if(!t&&ae>0&&l-ne<tt)return;s.textContent&&(s.textContent=""),s.classList.remove("mm-dm-unread-badge-visible"),ae=0,ne=l;return}const i=e>99?"99+":`${e}`;s.textContent!==i&&(s.textContent=i),s.classList.add("mm-dm-unread-badge-visible"),ae=e,ne=Date.now()},le=e=>e.closest(d.CHANNEL_LIST_ITEM),Re=()=>{for(const e of d.TEAM_HEADER){const t=document.querySelector(e);if(t)return t}return null},Ue=e=>{const t=e.closest("button");if(t&&t.querySelector(d.ICON_CHEVRON_DOWN))return t;const a=e.closest(".SidebarHeader")??e.parentElement;return a?Array.from(a.querySelectorAll("button")).find(s=>s.querySelector(d.ICON_CHEVRON_DOWN))??null:null},ut='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="512" height="512" x="0" y="0" viewBox="0 0 32 32" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="M16 2C8.28 2 2 8.28 2 16s6.28 14 14 14a1 1 0 0 0 1-1v-8h11.361a1 1 0 0 0 .951-.69c.453-1.39.685-2.845.688-4.308A1 1 0 0 0 30 16c0-7.72-6.28-14-14-14zm0 2c6.64 0 12 5.36 12 12 0 1.019-.22 2.017-.478 3H16a1 1 0 0 0-1 1v7.799C8.856 27.267 4 22.284 4 16 4 9.36 9.36 4 16 4z" fill="currentColor" opacity="1" data-original="#000000"></path><path d="M21.732 10.072a2 2 0 0 1-2.732.732 2 2 0 0 1-.732-2.732A2 2 0 0 1 21 7.34a2 2 0 0 1 .732 2.732zM10.804 13a2 2 0 0 1-2.732.732A2 2 0 0 1 7.34 11a2 2 0 0 1 2.732-.732A2 2 0 0 1 10.804 13zM24.245 15.861a2 2 0 0 1-2.45-1.414 2 2 0 0 1 1.415-2.45 2 2 0 0 1 2.45 1.415 2 2 0 0 1-1.415 2.45zM14.447 10.205a2 2 0 0 1-2.45-1.415 2 2 0 0 1 1.415-2.45 2 2 0 0 1 2.45 1.415 2 2 0 0 1-1.415 2.45z" fill="currentColor" opacity="1" data-original="#000000"></path></g></svg>',gt=()=>{new MutationObserver(()=>{const t=document.querySelector(d.USER_SETTINGS_MODAL);t&&(bt(t),ht(t))}).observe(document.body,{childList:!0,subtree:!0})},bt=e=>{const t=e.querySelector(d.TAB_LIST);if(!t)return;let a=t.querySelector(d.PLUGIN_PREFERENCES_HEADER);if(!a){const l=t.lastElementChild;l&&(a=l)}if(!a||a.querySelector(`#${A}`))return;const n=document.createElement("button");n.id=A,n.className="cursor--pointer style--none nav-pills__tab",n.setAttribute("aria-label",u("settings_title")),n.setAttribute("role","tab"),n.setAttribute("aria-selected","false"),n.tabIndex=-1,n.setAttribute("aria-controls",S);const s=document.createElement("span");s.className="icon",s.innerHTML=ut,s.style.width="16px",s.style.height="16px",s.style.display="inline-flex",s.style.alignItems="center",s.style.justifyContent="center",s.style.verticalAlign="middle",s.style.marginRight="8px";const i=s.querySelector("svg");i&&(i.style.width="100%",i.style.height="100%",i.style.fill="currentColor"),n.appendChild(s),n.appendChild(document.createTextNode(u("settings_title"))),n.addEventListener("click",l=>{l.preventDefault(),pt(e)}),t.addEventListener("click",l=>{const _=l.target.closest(d.NAV_PILLS_TAB);if(_&&_.id!==A){const o=e.querySelector(`#${A}`);o&&(o.classList.remove("active"),o.setAttribute("aria-selected","false"));const r=e.querySelector(`#${S}`);r&&(r.style.display="none",r.classList.add("hidden"))}}),a.appendChild(n)},ht=e=>{const t=e.querySelector(d.SETTINGS_CONTENT);if(!t||t.querySelector(`#${S}`))return;const a=document.createElement("div");a.id=S,a.setAttribute("role","tabpanel"),a.className="hidden",a.style.display="none";const n=document.createElement("div");n.className="modal-header";const s=document.createElement("button");s.type="button",s.className="close",s.dataset.dismiss="modal",s.innerHTML='<span aria-hidden="true">×</span>';const i=document.createElement("h4");i.className="modal-title";const l=document.createElement("div");l.className="modal-back",l.innerHTML='<i class="fa fa-angle-left" aria-label="Значок сворачивания"></i>';const m=document.createElement("span");m.textContent=u("settings_header"),i.appendChild(l),i.appendChild(m),n.appendChild(s),n.appendChild(i),a.appendChild(n);const _=document.createElement("div");_.className="user-settings";const o=document.createElement("div");o.className="userSettingDesktopHeader";const r=document.createElement("h3");r.className="tab-header",r.textContent=u("settings_header"),o.appendChild(r),_.appendChild(o);const c=document.createElement("div");c.className="divider-dark first",_.appendChild(c),_.appendChild(de(V,u("setting_resizer_title"),u("setting_resizer_desc"),!0)),_.appendChild(Oe()),_.appendChild(de(K,u("setting_dm_title"),u("setting_dm_desc"),!1)),_.appendChild(Oe()),_.appendChild(de(X,u("setting_calls_title"),u("setting_calls_desc"),!1)),a.appendChild(_),t.appendChild(a)},Oe=()=>{const e=document.createElement("div");return e.className="divider-light",e},pt=e=>{e.querySelectorAll(d.NAV_PILLS_TAB).forEach(i=>{i.classList.remove("active"),i.setAttribute("aria-selected","false")});const a=e.querySelector(`#${A}`);a&&(a.classList.add("active"),a.setAttribute("aria-selected","true")),e.querySelectorAll('.settings-content div > div[role="tabpanel"]').forEach(i=>{i.style.display="none"});const s=e.querySelector(`#${S}`);s&&(s.style.display="block",s.classList.remove("hidden"))},Be=(e,t=!1)=>v(e,t),ft=(e,t)=>{fe(e,t)},de=(e,t,a,n)=>{const s=document.createElement("div"),i=()=>{s.innerHTML="",s.className="section-min";const m=document.createElement("div");m.className="secion-min__header";const _=document.createElement("h4");_.className="section-min__title",_.textContent=t;const o=document.createElement("button");o.className="color--link style--none section-min__edit",o.innerHTML='<i class="icon-pencil-outline" aria-hidden="true" title="Значок редактирования"></i><span>'+u("label_edit")+"</span>",o.onclick=()=>l(),m.appendChild(_),m.appendChild(o);const r=document.createElement("div");r.className="section-min__describe";const c=Be(e,n);r.textContent=u(c?"label_on":"label_off"),s.appendChild(m),s.appendChild(r)},l=()=>{s.innerHTML="",s.className="section-max form-horizontal";const m=document.createElement("h4");m.className="col-sm-12 section-title",m.textContent=t;const _=document.createElement("div");_.className="sectionContent col-sm-10 col-sm-offset-2";const o=document.createElement("div");o.className="setting-list";const r=document.createElement("div");r.className="setting-list-item";const c=document.createElement("fieldset"),E=document.createElement("legend");E.className="form-legend hidden-label",E.textContent=t,c.appendChild(E);const b=Be(e,n);let g=b;const Pe=($e,Nt)=>{const W=document.createElement("div");W.className="radio";const ue=document.createElement("label"),U=document.createElement("input");U.type="radio",U.name=e,U.checked=$e===b,U.onchange=()=>{g=$e};const We=document.createElement("span");return We.textContent=Nt,ue.appendChild(U),ue.appendChild(We),W.appendChild(ue),W.appendChild(document.createElement("br")),W};c.appendChild(Pe(!0,u("label_on"))),c.appendChild(Pe(!1,u("label_off")));const _e=document.createElement("div");_e.className="mt-5",_e.innerHTML=`<span>${a}</span>`,c.appendChild(_e),r.appendChild(c);const R=document.createElement("div");R.className="setting-list-item",R.appendChild(document.createElement("hr"));const P=document.createElement("button");P.className="btn btn-primary",P.textContent=u("label_save"),P.onclick=()=>{ft(e,g),window.dispatchEvent(new CustomEvent("mm-extension-setting-changed",{detail:{key:e,value:g}})),i()};const $=document.createElement("button");$.className="btn btn-tertiary",$.textContent=u("label_cancel"),$.onclick=()=>i(),R.appendChild(P),R.appendChild($),o.appendChild(r),o.appendChild(R),_.appendChild(o),s.appendChild(m),s.appendChild(_)};return i(),s},ke="mm-hide-calls-enabled",Et=()=>{window.addEventListener("mm-extension-setting-changed",e=>{e.detail?.key===X&&He()}),He()},He=()=>{v(X)?document.documentElement.classList.add(ke):document.documentElement.classList.remove(ke)},oe=new Map;let qe=!1;const vt={matches:["<all_urls>"],runAt:"document_end",async main(){if(!je())return;await Je(),gt(),Et(),St();const e=()=>{const a=Z();return a?(At(a),Ke(a),nt(a),!0):!1};if(e())return;const t=new MutationObserver(()=>{e()&&t.disconnect()});t.observe(document.documentElement,{childList:!0,subtree:!0}),window.setTimeout(()=>t.disconnect(),1e4)}},St=async()=>{if(!qe)try{const e=await fetch("/api/v4/users/me/teams");if(e.ok){const t=await e.json();if(Array.isArray(t)){t.forEach(n=>{n.id&&n.display_name&&oe.set(n.id,n.display_name)}),qe=!0;const a=Z();if(a){const n=a.querySelector(d.DROPPABLE_TEAMS);n&&(n.querySelectorAll(".mm-team-label").forEach(i=>i.remove()),ce(n))}}}}catch(e){console.warn("Failed to fetch teams",e)}},At=e=>{const t=e.querySelector(d.DROPPABLE_TEAMS);if(!t||(ce(t),t.dataset.mmObserverAttached==="true"))return;t.dataset.mmObserverAttached="true",new MutationObserver(()=>ce(t)).observe(t,{childList:!0,subtree:!0})},ce=e=>{Array.from(e.querySelectorAll(d.DRAGGABLE_TEAM_ITEM)).forEach(a=>{if(a.id==="select_teamTeamButton"||a.querySelector(".mm-team-label"))return;const n=yt(a);if(!n)return;const s=document.createElement("span");s.className="mm-team-label",s.textContent=n;const i=a.querySelector(".team-container");i?a.insertBefore(s,i.nextSibling):a.appendChild(s)})},yt=e=>{if(e.id==="select_teamTeamButton")return null;const t=e.dataset.rbdDraggableId;if(t&&oe.has(t))return oe.get(t);const a=Dt(e);if(a)return a;const n=e.getAttribute("aria-label");if(!n)return null;let s=n.trim();return s=s.replace(/^команда\s+/i,""),s=s.replace(/\s+непрочитан\w*$/i,""),s.trim()||null},Dt=e=>{const a=e.querySelector('[data-testid="teamIconImage"], [data-testid="teamIconInitial"]')?.getAttribute("aria-label")?.trim();if(!a)return null;let n=a.match(/команды\s+(.+)$/i);return n?.[1]?n[1].trim():a.endsWith(" Team Image")?a.replace(/\s+Team Image$/,"").trim():a.endsWith(" Team Initials")?a.replace(/\s+Team Initials$/,"").trim():a};function q(e,...t){}const Ct={debug:(...e)=>q(console.debug,...e),log:(...e)=>q(console.log,...e),warn:(...e)=>q(console.warn,...e),error:(...e)=>q(console.error,...e)},Ge=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome;var It=class Fe extends Event{static EVENT_NAME=me("wxt:locationchange");constructor(t,a){super(Fe.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=a}};function me(e){return`${Ge?.runtime?.id}:content:${e}`}function Lt(e){let t,a;return{run(){t==null&&(a=new URL(location.href),t=e.setInterval(()=>{let n=new URL(location.href);n.href!==a.href&&(window.dispatchEvent(new It(n,a)),a=n)},1e3))}}}var Tt=class ge{static SCRIPT_STARTED_MESSAGE_TYPE=me("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Lt(this);receivedMessageIds=new Set;constructor(t,a){this.contentScriptName=t,this.options=a,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}get signal(){return this.abortController.signal}abort(t){return this.abortController.abort(t)}get isInvalid(){return Ge.runtime?.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,a){const n=setInterval(()=>{this.isValid&&t()},a);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(t,a){const n=setTimeout(()=>{this.isValid&&t()},a);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(t){const a=requestAnimationFrame((...n)=>{this.isValid&&t(...n)});return this.onInvalidated(()=>cancelAnimationFrame(a)),a}requestIdleCallback(t,a){const n=requestIdleCallback((...s)=>{this.signal.aborted||t(...s)},a);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(t,a,n,s){a==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),t.addEventListener?.(a.startsWith("wxt:")?me(a):a,n,{...s,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Ct.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:ge.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(t){const a=t.data?.type===ge.SCRIPT_STARTED_MESSAGE_TYPE,n=t.data?.contentScriptName===this.contentScriptName,s=!this.receivedMessageIds.has(t.data?.messageId);return a&&n&&s}listenForNewerScripts(t){let a=!0;const n=s=>{if(this.verifyScriptStartedEvent(s)){this.receivedMessageIds.add(s.data.messageId);const i=a;if(a=!1,i&&t?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}};function Zt(){}function G(e,...t){}const Mt={debug:(...e)=>G(console.debug,...e),log:(...e)=>G(console.log,...e),warn:(...e)=>G(console.warn,...e),error:(...e)=>G(console.error,...e)};return(async()=>{try{const{main:e,...t}=vt;return await e(new Tt("content",t))}catch(e){throw Mt.error('The content script "content" crashed on startup!',e),e}})()})();
content;